{"uid":"232b77110b3aeef","name":"test_modify_wiki_page_success_create_new_wiki_and_page","fullName":"src.tests.ado.wiki.test_unit_ado_wiki.TestWikiApiWrapperPositive#test_modify_wiki_page_success_create_new_wiki_and_page","historyId":"d89cb6d414a46cf81d3510ca8b998d45","time":{"start":1742468329529,"stop":1742468329533,"duration":4},"description":"Test successful creation of new wiki and a page when wiki does not exist.","descriptionHtml":"<p>Test successful creation of new wiki and a page when wiki does not exist.</p>\n","status":"failed","statusMessage":"AssertionError: assert ToolException(\"Unable to modify wiki page: WikiPageCreateOrUpdateParameters.__init__() got an unexpected keyword argument 'name'\") == 'Page created successfully'","statusTrace":"self = <src.tests.ado.wiki.test_unit_ado_wiki.TestWikiApiWrapperPositive object at 0x7fcd67320b30>\nwiki_wrapper = AzureDevOpsApiWrapper(organization_url='https://dev.azure.com/test-repo', project='project', token='token_value')\ndefault_values = {'organization_url': 'https://dev.azure.com/test-repo', 'project': 'project', 'token': 'token_value'}\n\n    def test_modify_wiki_page_success_create_new_wiki_and_page(self, wiki_wrapper, default_values):\n        \"\"\"Test successful creation of new wiki and a page when wiki does not exist.\"\"\"\n        with patch(\"azure.devops.v7_0.wiki.wiki_client.WikiClient.get_all_wikis\") as mock_get_all_wikis, \\\n            patch(\"azure.devops.v7_0.wiki.wiki_client.WikiClient.create_wiki\") as mock_create_wiki, \\\n            patch(\"azure.devops.v7_0.wiki.wiki_client.WikiClient.get_page\") as mock_get_page, \\\n            patch(\"azure.devops.v7_0.wiki.wiki_client.WikiClient.create_or_update_page\") as mock_create_or_update_page, \\\n            patch(\"azure.devops.v7_0.core.core_client.CoreClient.get_projects\") as mock_get_projects:\n    \n            mock_get_all_wikis.return_value = []\n            mock_create_wiki.return_value = MagicMock()\n            mock_get_page.side_effect = Exception(\"Ensure that the path of the page is correct and the page exists\")  # Simulate \"path not found\"\n            mock_project = MagicMock()\n            mock_project.name = default_values[\"project\"]\n            mock_project.id = \"proj-id\"\n            mock_get_projects.return_value = [mock_project]\n            mock_create_or_update_page.return_value = \"Page created successfully\"\n    \n            wiki_wrapper._client.get_all_wikis = mock_get_all_wikis\n            wiki_wrapper._client.create_wiki = mock_create_wiki\n            wiki_wrapper._client.get_page = mock_get_page\n            wiki_wrapper._client.create_or_update_page = mock_create_or_update_page\n            wiki_wrapper._core_client.get_projects = mock_get_projects\n    \n            result = wiki_wrapper.modify_wiki_page(\n                wiki_identified=\"new-wiki\",\n                page_name=\"/new-page\",\n                page_content=\"New page content\",\n                version_identifier=\"branch_name\",\n                version_type=\"branch\"\n            )\n    \n>           assert result == \"Page created successfully\"\nE           assert ToolException(\"Unable to modify wiki page: WikiPageCreateOrUpdateParameters.__init__() got an unexpected keyword argument 'name'\") == 'Page created successfully'\n\nsrc/tests/ado/wiki/test_unit_ado_wiki.py:301: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"test_suite_cleanup","time":{"start":1742468325924,"stop":1742468325927,"duration":3},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"default_values","time":{"start":1742468329502,"stop":1742468329502,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"wiki_wrapper","time":{"start":1742468329502,"stop":1742468329529,"duration":27},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Test successful creation of new wiki and a page when wiki does not exist.","status":"failed","statusMessage":"AssertionError: assert ToolException(\"Unable to modify wiki page: WikiPageCreateOrUpdateParameters.__init__() got an unexpected keyword argument 'name'\") == 'Page created successfully'","statusTrace":"self = <src.tests.ado.wiki.test_unit_ado_wiki.TestWikiApiWrapperPositive object at 0x7fcd67320b30>\nwiki_wrapper = AzureDevOpsApiWrapper(organization_url='https://dev.azure.com/test-repo', project='project', token='token_value')\ndefault_values = {'organization_url': 'https://dev.azure.com/test-repo', 'project': 'project', 'token': 'token_value'}\n\n    def test_modify_wiki_page_success_create_new_wiki_and_page(self, wiki_wrapper, default_values):\n        \"\"\"Test successful creation of new wiki and a page when wiki does not exist.\"\"\"\n        with patch(\"azure.devops.v7_0.wiki.wiki_client.WikiClient.get_all_wikis\") as mock_get_all_wikis, \\\n            patch(\"azure.devops.v7_0.wiki.wiki_client.WikiClient.create_wiki\") as mock_create_wiki, \\\n            patch(\"azure.devops.v7_0.wiki.wiki_client.WikiClient.get_page\") as mock_get_page, \\\n            patch(\"azure.devops.v7_0.wiki.wiki_client.WikiClient.create_or_update_page\") as mock_create_or_update_page, \\\n            patch(\"azure.devops.v7_0.core.core_client.CoreClient.get_projects\") as mock_get_projects:\n    \n            mock_get_all_wikis.return_value = []\n            mock_create_wiki.return_value = MagicMock()\n            mock_get_page.side_effect = Exception(\"Ensure that the path of the page is correct and the page exists\")  # Simulate \"path not found\"\n            mock_project = MagicMock()\n            mock_project.name = default_values[\"project\"]\n            mock_project.id = \"proj-id\"\n            mock_get_projects.return_value = [mock_project]\n            mock_create_or_update_page.return_value = \"Page created successfully\"\n    \n            wiki_wrapper._client.get_all_wikis = mock_get_all_wikis\n            wiki_wrapper._client.create_wiki = mock_create_wiki\n            wiki_wrapper._client.get_page = mock_get_page\n            wiki_wrapper._client.create_or_update_page = mock_create_or_update_page\n            wiki_wrapper._core_client.get_projects = mock_get_projects\n    \n            result = wiki_wrapper.modify_wiki_page(\n                wiki_identified=\"new-wiki\",\n                page_name=\"/new-page\",\n                page_content=\"New page content\",\n                version_identifier=\"branch_name\",\n                version_type=\"branch\"\n            )\n    \n>           assert result == \"Page created successfully\"\nE           assert ToolException(\"Unable to modify wiki page: WikiPageCreateOrUpdateParameters.__init__() got an unexpected keyword argument 'name'\") == 'Page created successfully'\n\nsrc/tests/ado/wiki/test_unit_ado_wiki.py:301: AssertionError","steps":[],"attachments":[{"uid":"c492fea50c2a3c19","name":"log","source":"c492fea50c2a3c19.txt","type":"text/plain","size":295}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"wiki_wrapper::0","time":{"start":1742468329555,"stop":1742468329555,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_suite_cleanup::0","time":{"start":1742468330309,"stop":1742468330309,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"positive"},{"name":"tag","value":"ado_wiki"},{"name":"tag","value":"unit"},{"name":"parentSuite","value":"src.tests.ado.wiki"},{"name":"suite","value":"test_unit_ado_wiki"},{"name":"subSuite","value":"TestWikiApiWrapperPositive"},{"name":"host","value":"fv-az2029-654"},{"name":"thread","value":"2535-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"src.tests.ado.wiki.test_unit_ado_wiki"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":["unit","positive","ado_wiki"]},"source":"232b77110b3aeef.json","parameterValues":[]}